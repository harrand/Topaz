<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.9.2"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Topaz 3.1 Documentation</title>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
        <link href="custom_dark_theme.css" rel="stylesheet" type="text/css" />
        <link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="doxy-boot.js"></script>
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand"><img src = "tz.png" width="2%" height="2%"></a>
                    <a class="navbar-brand" href="index.html" style="font-size: xx-large; text-decoration: none;">Topaz</a>
                    <a class="navbar-brand" href="modules.html">Modules</a>
                    <a class="navbar-brand" href="annotated.html">Classes</a>
                    <a class="navbar-brand" href="tools.html">Tools</a>
                    <a class="navbar-brand" href="tzsl.html">TZSL</a>
                            <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part --><!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Tools </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This page describes all internal tools used in the Topaz engine.</p>
<h1><a class="anchor" id="TZSLC"></a>
TZSLC – Topaz Shader Language Compiler</h1>
<p >TZSLC is a tool which transpiles .tzsl shaders to produce output files appropriate for various render-api GLSL dialects.</p><ul>
<li>In a Vulkan environment, TZSLC produces SPIR-V binaries.</li>
<li>In an OpenGL environment, TZSLC produces GLSL sources.</li>
</ul>
<p >TZSLC is available under the CMake target <code>tzslc</code>. It has no additional documentation. </p>
<h2><a class="anchor" id="TZSL"></a>
TZSL</h2>
<p >Information on the shading language TZSL can be found at: <a class="el" href="tzsl.html">Topaz Shader Language</a> </p>
<h2><a class="anchor" id="Usage"></a>
TZSLC Usage</h2>
<p ><code>tzslc &lt;path-to-tzsl-file&gt; [-m{module-name}]...</code></p>
<h3><a class="anchor" id="tzslc_modules"></a>
Usage – Modules</h3>
<p >You can pass zero or more modules to TZSLC. TZSLC will not preprocess valid .tzsl syntax unless the corresponding module is passed. For example, the module to preprocess image samplers would be called 'sampler', so the tzslc runtime flags would include <code>-msampler</code>.</p>
<p >Note that <code>-mall</code> is a pseudo-module which causes TZSLC to use all available modules.</p>
<p >But what's the purpose of TZSLC? Why not just use .glsl shaders and be done with it? </p><hr  />
 <h2><a class="anchor" id="problem1"></a>
Problem: Using an image sampler within a .glsl shader</h2>
<p >GLSL is somewhat flexible &ndash; Render-apis tend to have their own dialect of GLSL which they use. This means that while often .glsl shaders can be used, for example, both OpenGL and Vulkan - It is not guaranteed to be the case.</p>
<p >TZSLC exists to provide new syntax which preprocesses down to the desired render-api dialect. Consider the following GLSL code to declare a uniform sampler2D: </p>
<h3><a class="anchor" id="VK"></a>
Vulkan GLSL</h3>
<p ><code>layout(binding = 1) uniform sampler2D tex_sampler;</code> </p>
<h3><a class="anchor" id="OGL"></a>
OpenGL GLSL</h3>
<p ><code>layout(location = 1) uniform sampler2D tex_sampler;</code> </p>
<h2><a class="anchor" id="solution1"></a>
Solution: Using a .tzsl shader</h2>
<h3><a class="anchor" id="TZSL"></a>
TZSL</h3>
<p ><code>tz_sampler2D_uniform(1) tex_sampler;</code></p>
<p >Correctly resolves to either of the two outputs above, depending on the build config used to build the given TZSLC process. </p><hr  />
 <h2><a class="anchor" id="problem2"></a>
Problem: Different behaviour between OpenGL/Vulkan</h2>
<p >Sometimes in shaders you may have functionality for a specific render-api but there is no common behaviour provided by TZSL. For example, Vulkan and OpenGL texture-coordinates are slightly different. You might want code which transforms the texture-coordinates to another format only if on Vulkan.</p>
<p >Unfortunately in GLSL there are no magic defines telling you which render-api will be building the shader. </p>
<h2><a class="anchor" id="solution2"></a>
Solution: Vulkan-only or OpenGL-only code fragments</h2>
<p >Fortunately, when building with TZSLC such defines are injected into the code while transpiling to GLSL. </p>
<h3><a class="anchor" id="TZSL"></a>
TZSL</h3>
<div class="fragment"><div class="line">layout(location = 0) in vec2 texcoord;</div>
<div class="line">layout(location = 0) out vec4 output_colour;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> main()</div>
<div class="line">{</div>
<div class="line">     vec2 texcoord_transformed = texcoord;</div>
<div class="line">     <span class="comment">// Assume texcoord is in OpenGL format. If we&#39;re on Vulkan, we need to transform it or the image will be 90 degrees off.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">     #if TZ_VULKAN</span></div>
<div class="line">         texcoord_transformed.y = 1.0 - texcoord_transformed.y;</div>
<div class="line"><span class="preprocessor">     #endif</span></div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Now identical output for both render-apis.</span></div>
<div class="line">     output_colour = texture(tex_sampler, texcoord_transformed);</div>
<div class="line"> }</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
    <nav class="navbar navbar-default" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="https://github.com/Harrand/Topaz" style="margin-right: 10px;">GitHub: topaz-master</a>
                <a class="navbar-brand" href="https://harrand.github.io/" style="margin-right: 10px;">harrand.github.io</a>
            </div>
        </div>
    </nav>
    <p>Generated: Wed Sep 29 2021 01:11:50</p>
</small></address>
</body>
</html>